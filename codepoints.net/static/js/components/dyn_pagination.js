define(["jquery","components/jquery.cachedajax","components/jquery.tooltip"],function(e){function n(e,n,r){var i=r?" reverse":"";e.find(".mask").remove(),e.removeClass("waiting").addClass("exiting"+i),n.addClass("entering"+i).insertAfter(e).tooltip(),window.setTimeout(function(){n.removeClass("entering"+i),e.removeClass("exiting"+i).remove()},t)}var t=1e3;e.fn.enhancePagination=function(){return this.on("click",".cp-list .pagination a",function(){var t=e(this),r=this.href,i=t.closest(".cp-list"),s=i.data("page"),o=e('<div class="mask"></div>'),u=t.closest("li").attr("value");return i.append(o).delay(200).promise().then(function(){e(this).addClass("waiting")}),e.cachedAjax(r).then(function(t){var o=e(e.parseHTML(t)).find(".cp-list");o.length&&("pushState"in window.history&&window.history.pushState({page:u},"",r),"_paq"in window&&window._paq.push(["trackPageView"]),n(i,o,s>u))}),!1}),this}});