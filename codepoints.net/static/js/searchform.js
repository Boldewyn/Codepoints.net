!function(){"use strict";function a(a){var d,e=Array.prototype.slice.call(arguments,1);c in b.catalog&&a in b.catalog[c]&&(a=b.catalog[c][a]);for(;e.length;)d=e.shift(),a=a.replace(/%s/,d);return a}var b,c=document.documentElement.getAttribute("lang");b="gettext"in window?window.gettext:{catalog:{}},$(".extended.searchform").each(function(){function b(a,b,c){var d=$('<ul class="query-choose"></ul>');$.each(b,function(b,e){d.append($('<li><a class="button" href="#">'+e[1]+"</a></li>").on("click tap","a",function(){return c(a,e[1],e[0]),d.dialog("close").dialog("destroy").remove(),d=null,!1}))}),d.dialog({title:a,modal:!0,width:Math.min($(window).width(),1030)})}function c(c,d,e){var f="",h=$.noop;return e.is("select")?(f=" y",h=function(){return e.find('option[value=""]')[0].selected=!1,e.find('option[value="1"]')[0].selected?(e.find('option[value="1"]')[0].selected=!1,e.find('option[value="0"]')[0].selected=!0,$(this).find(".value").addClass("n").removeClass("y")):(e.find('option[value="0"]')[0].selected=!1,e.find('option[value="1"]')[0].selected=!0,$(this).find(".value").addClass("y").removeClass("n")),!1}):h=function(){var a=$(this),d=i[c];b(c,d,function(b,c,d){a.find(".value").text(c),e[0].checked=!1,d[0].checked=!0})},$('<li class="query-item"></li>').html('<span class="key">'+c+':</span> <span class="value'+f+'" title="'+a("click to change")+'">'+d+'</span> <button type="button">'+a("remove")+"</button>").find("button").button({text:!1,icons:{primary:"ui-icon-close",secondary:!1}}).on("click tab",function(){var a=$(this).closest("li");return e.is(":checkbox")?e[0].checked=!1:e.find('option[value=""]')[0].selected=!0,a.slideUp("fast",a.remove),!1}).end().on("click tab",h).tooltip().appendTo(g)}var d=$(this),e=$(".propsearch, .boolsearch",d).hide(),f=$(".submitset",d),g=$('<ul class="query-add ui-widget ui-widget-content ui-corner-all"></ul>').insertBefore(f),h=$('<p><button type="button">'+a("+ add new query")+"</button></p>").insertBefore(f).find("button"),i={},j=$('<ul class="ui-menu ui-widget ui-widget-content" tabindex="0"></ul>');e.filter(".propsearch").each(function(){var a=$(this),b=[],d=$("legend",a).text().replace(/:\s*$/,"");$(":checkbox",a).each(function(){var e=$(this),f=$('label[for="'+this.id+'"]',a).text();b.push([e,f]),e[0].checked&&c(d,f,e)}),i[d]=b}),i["Other Property"]=[],e.filter(".boolsearch").each(function(){var a=$("select",this),b=$("label",this).text();i["Other Property"].push([a,b]),a.find('option[value="1"]')[0].selected&&c("Other Property",b,a)}),$.each(i,function(a,b){j.append($('<li class="ui-menu-item"><a href="#">'+a+"</a></li>").data("v",b).data("k",a))}),$(document).on("keydown click tap",function(){j.slideUp()}),j.css({display:"none",position:"absolute"}).appendTo("body").on("click tap","li",function(){var a=$(this);return b(a.data("k"),a.data("v"),function(a,b,d){d.is(":checkbox")?d[0].checked=!0:d.find('option[value="1"]')[0].selected=!0,c(a,b,d)}),j.slideUp(),!1}).on("keydown",function(a){if(!(a.shiftKey||a.metaKey||a.ctrlKey||a.altKey)){var b=j.find("a:focus"),c=$();switch(a.which){case 38:b.length&&(c=b.parent().prev("li").find("a")),c.length||(c=j.find("a:last"));break;case 40:b.length&&(c=b.parent().next("li").find("a")),c.length||(c=j.find("a:first"))}if(c.length)return c.focus(),a.preventDefault(),a.stopPropagation(),!1}}),h.on("click tap",function(){return j.show().position({my:"left top",at:"left bottom",of:this,collision:"fit fit"}).hide().slideDown().focus(),!1}),g.on("click tap",function(a){return a.target===this?(h.trigger("click"),!1):void 0})})}();